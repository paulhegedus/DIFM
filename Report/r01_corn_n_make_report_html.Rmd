# Field Management Information

+ Baseline nitrogen rate of `r grower_chosen_rate_n` K.
+ Nitrogen target rates: `r paste0(tgtn_ls, collapse = ", ")` 
+ Planter width: `r planter_width` feet, variable-rate controlled by 15-foot quarter-sections
+ Harvester width: `r harvester_width` feet

# Summary  

A corn nitrogen rate trial was conducted on the field_name_here field in crop year 2020. The trial was <!--NEED to determine and assign: "was" or "was not". If the trial was not implemented accurately, for now we can write explanations by hand.  But eventually, we could probably write up a list of common reasons why implementation wasn't accurate, and choose one from that list to put in the text.--> implemented with a high level of accuracy. The data and model provide an estimate that, under growing conditions identical to those of the field in 2020, implementing the recommended site-specific nitrogen rate strategy would have increased profits by \$`r round(whole_profits_test_n[type_short == "ovg", point_est_dif], digits = 0)` per acre. _statement-whole-field-pi-here_.


<!---CHUNK_PAGEBREAK--->

# Economic Results and Implications 

Figure \@ref(fig:optimal-variable-s) shows the analysis's recommended site-specific nitrogen rate map. The figure was calculated using data from each management zone separately. (Details about how management zones were determined are provided later in this report.)  A generalized additive model (GAM) regression was used to model yield as a function of nitrogen rate in each zone, and then given that model estimation, the profit-maximizing nitrogen rate was found for each zone. Table \@ref(tab:yield-summary-table) lists for each zone the estimated per-acre yields that would have resulted, given the year's growing conditions, from applying the grower-chosen planting strategy and the estimated optimal nitrogen rate derived from the data and model. 

```{r optimal-variable-n, fig.cap = "Estimated Optimal site-specific nitrogen rate Rx", fig.height = 5}

data_sf_n %>% 
  mutate(opt_n = round(opt_n)) %>% 
  ggplot(data = .) +
    geom_sf(aes(fill = factor(opt_n)), size = 0.1) +
  scale_fill_brewer(
    palette = "Greens",
    direction = 1,
    name = "Optimal Nitrogen Rate \n (lbs)"
  ) +
  theme_void() +
  theme(
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12),
    legend.position = "bottom"
  ) +
  fig_theme_sp

# st_write(opt_S_sf, dsn = paste0("CLC_Soy_2020 Analyses/Reports/", field_name), layer = "opt_S_map", driver = "ESRI Shapefile", append = FALSE)
```


_results-and-discussions-here_

<br>
<br>

```{r yield-summary-table, tab.cap = "Summary yield and nitrogen rate data by zone"}
sum_tab <- copy(opt_gc_data_n) %>% 
  .[order(zone_txt, type),] %>% 
  .[, .(zone_txt, type, yield_hat, n_rate)] %>% 
  .[, type := case_when(
    type == "gc" ~ "Grower-chosen",
    type == "opt_v" ~ "Optimal site-specific",
  )] %>% 
  .[, n_rate := round(n_rate, digits = 1)] %>% 
  .[, yield_hat := round(yield_hat, digits = 1)] %>% 
  setnames(names(.), c("Zone", "Strategy", "Yield (bu/acre)", "Nitrogen Rate")) %>% 
  flextable() %>% 
  font(fontname = "Times", part = "all") %>% 
  hline(
    i = c(2, 4, 6, 8),
    border = fp_border(
      color = "black",
      width = 1
    )
  ) %>% 
  merge_v(
    j = 1
  ) %>% 
  align(
    align = "center",
    part = "all"
  ) %>% 
  fontsize(
    size = 12,
    part = "all"
  ) %>% 
  autofit() %>% 
  fix_border_issues()  

sum_tab

```

<br>
<br>


```{r whole-field-profit-comp, fig.cap = "Confidence intervals of whole-field profit differences, by management strategy", fig.height = 3.5, fig.width = 6.5}

ggplot(data = whole_profits_test_n) +
  geom_errorbar(
    aes(
    ymin = point_est_dif - point_est_dif_se * 1.96, 
    ymax = point_est_dif + point_est_dif_se * 1.96, 
    x = type
    ),
    size = 0.8
  ) +
  geom_point(
    aes(
      y = point_est_dif,
      x = type
    ),
    size = 4,
    color = "red"
  ) +
  geom_hline(yintercept = 0, color = "red", size = 1.5) +
  theme_bw() +
  ylab("Difference in Net Revenue ($/acre)") +
  xlab("") +
  theme(
    axis.title.x = element_text(size = 12, vjust = -1),
    axis.title.y = element_text(size = 12),
    axis.text.x = element_text(size = 9),
    axis.text.y = element_text(size = 9)
  ) +
  fig_theme_nonsp

```

# Trial Design and Implementation

Figure \@ref(fig:tgts-yield-ap) displays the trial design and the resultant as-applied map.  Casual observation shows that <!--NEED to determine and assign:  "trial implementation was basically accurate", or "the accuracy of trial implementation was limited by" (add text by hand) -->.  The field's status quo planting plan (that is, the one that would have been used had there been no field trial conducted) was to _grower-plan-here_.  Plots were all `r plot_width` feet wide.  Plot were all between <!--shortest_plot_length_hereK--> and <!--longest_plot_length_hereK-->feet long. A rate of <!--buffer_zone_rate_hereK--> per acre was assigned to a buffer zone around the perimeter of the trial, but observations from the buffer zone were not included as part of the trial in later analysis. Figure \@ref(fig:tgts-yield-ap) pairs the trial's design, as-applied, and yield maps.  No relationship between nitrogen rate and yield is readily detectable with the naked eye. 

```{r trial-design, results = "hide"}
#/*----------------------------------*/
#' ## Trial-design
#/*----------------------------------*/
if (sn_ew_ratio > 1.1) {
  tm_tgts <- tm_shape(trial_design) +
    tm_fill(
      col = "tgt_n", 
      palette = "Greens",
      title = "Targeted\nNitrogen Rate\n(lbs)",
      # legend.is.portrait = FALSE,
      style = "cat"
    ) +
    tm_layout_to_add + 
    tm_layout(
      # legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )

} else {

  tm_tgts <- tm_shape(trial_design) +
    tm_fill(
      col = "tgt_n", 
      palette = "Greens",
      title = "Targeted Nitrogen Rate (lbs)",
      legend.is.portrait = FALSE,
      style = "cat"
    ) +
    tm_layout_to_add + 
    tm_layout(
      legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )

}

# g_tgts <- ggplot() +
#   geom_sf(
#     data = trial_design, 
#     aes(fill = factor(tgt_seed)),
#     size = 0.1
#   ) +
#   scale_fill_brewer(
#     palette = "Greens",
#     direction = 1,
#     name = "Targeted Seed Rate (1000 seeds)",
#     guide = guide_legend(
#       ncol = 4,
#       title.position = "top"
#     )
#   ) +
#   theme_void() +
#   theme(
#     legend.position = "bottom",
#     legend.text = element_text(size = 12),
#     legend.title = element_text(size = 12),
#     legend.key.width =  unit(0.5, "cm"),
#     legend.key.height =  unit(0.2, "cm")
#   ) +
#   fig_theme_sp

```

```{r as-applied-n-map, results = "hide"}
#/*----------------------------------*/
#' ## As-applied Nitrogen Rate
#/*----------------------------------*/

asp_plot_data <- trial_design %>% 
  filter(type != "Headland") %>% 
  as_applied_s[., ]

if (sn_ew_ratio > 1.1) {
  tm_asp <- tm_shape(asp_plot_data) +
    tm_fill(
      col = "n_rate", 
      palette = "Greens",
      title = "As-applied\nNitrogen Rate\n(lbs)",
      # legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      # legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )

} else {
 tm_asp <- tm_shape(asp_plot_data) +
  tm_fill(
    col = "n_rate", 
    palette = "Greens",
    title = "As-applied Nitrogen Rate (lbs)",
    legend.is.portrait = FALSE,
    style = "cont"
  ) +
  tm_layout_to_add + 
  tm_layout(
    legend.outside.position = "bottom",
    legend.position = c(0.25, 0.25)
  )
 
}
 
# g_ap <- ggplot() +
#   geom_sf(
#     data = asp_plot_data, 
#     aes(fill = seed_rate),
#     size = 0
#   ) +
#   scale_fill_distiller(
#     palette = "Greens",
#     direction = 1,
#     name = "As-planted Seed Rate (1000 seeds)",
#     guide = guide_colorbar(
#       title.position = "top"
#     )
#   ) +
#   # guides(color = guide_legend(title.position = "left")) +
#   theme_void() +
#   theme(
#     legend.position = "bottom",
#     legend.text = element_text(size = 12),
#     legend.title = element_text(size = 12),
#     legend.key.width =  unit(0.6, "cm")
#   ) +
#   fig_theme_sp

```

```{r gen-raw-yield-map, results = "hide"}
#/*----------------------------------*/
#' ## Raw yield
#/*----------------------------------*/
ry_plot_data <- trial_design %>% 
  filter(type != "Headland") %>% 
  yield_polygons[., ]

if (sn_ew_ratio > 1.1) {
  tm_ry <- tm_shape(filter(ry_plot_data, flag_bad == 0)) +
    tm_fill(
      col = "yield_vol", 
      palette = "YlOrBr",
      title = "Yield\n(bu/acre)",
      # legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      # legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
} else {
  tm_ry <- tm_shape(filter(ry_plot_data, flag_bad == 0)) +
    tm_fill(
      col = "yield_vol", 
      palette = "YlOrBr",
      title = "Yield \n (bu/acre)",
      legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
}
 

# g_ry <- ggplot() +
#   geom_sf(
#     data = filter(ry_plot_data, flag_bad == 0),
#     aes(fill = yield_vol),
#     size = 0
#   ) +
#   scale_fill_distiller(
#     palette = "YlOrBr",
#     direction = 1,
#     name = "Yield (bu/acre)",
#     guide = guide_colorbar(
#       title.position = "top"
#     )
#   ) +
#   theme_void() +
#   theme(
#     legend.position = "bottom",
#     legend.text = element_text(size = 12),
#     legend.title = element_text(size = 12),
#     legend.key.width =  unit(0.6, "cm")
#   ) +
#   fig_theme_sp

```

```{r tgts-yield-ap-gg, fig.cap = "Trial design, as-applied nitrogen rates, and corn yields, 2020)", fig.height = 8.5, eval = F}

gr_tgts <- ggplotGrob(g_tgts)
gr_ap <- ggplotGrob(g_ap)
gr_ry <- ggplotGrob(g_ry)

g_inset <- ggplot() +
  coord_equal(
    xlim = c(0, 1),
    ylim = c(0, 1),
    expand = FALSE
  ) + 
  fig_theme_sp +
  annotation_custom(
    gr_tgts, 
    xmin = 0, 
    xmax = 0.5, 
    ymin = 0.5,
    ymax = 1
  ) +
  annotation_custom(
    gr_ap, 
    xmin = 0.5, 
    xmax = 1, 
    ymin = 0.5,
    ymax = 1
  ) 
  +
  annotation_custom(
    gr_ry, 
    xmin = 0, 
    xmax = 0.5, 
    ymin = 0,
    ymax = 0.5
  )  

g_inset
```

```{r tgts-yield-ap, fig.cap = "Trial design, as-applied nitrogen rates, and corn yields, 2020)", fig.height = 10}
tmap_arrange(tm_tgts, tm_asp, tm_ry, ncol = 2)  
```

# Overview of Data Processing

The variable-rate applicator and yield monitor provided raw as-applied and harvest data. An initial cleaning removed observations with extreme yield or as-applied rates ("outliers") from the raw data. Points were also removed from the headlands, where the data is less reliable due to differences in sun exposure, changes in driving speed, potential application overlaps, etc. The yield points were grouped into polygons using the distance between points, swath width, and the the headings recorded in the raw yield data. Subplots were created by grouping contiguous yield polygons with similar as-applied rates into sets of four.  (Subplots were treated as the unit of observation in later analysis.) 

A yield polygon was judged as having a "dominant treatment" when the standard deviation of the yield values at points within the polygon was below a threshold level. Adjacent as-applied polygons were judged as not being in the same group when the difference in application rates surpassed a threshold level.  Polygons without a dominant treatment were not included in the data set used for analysis. This technique also helped eliminate "transition zones, which are areas in which the data show where the harvester and planter did not immediately adjust to new target rates or yield levels when passing from one plot into another. Each subplot's mean as-applied rate and yield were recorded as data. Finally, for each subplot the means of the electrical-conductivity data, SSURGO soil data, and USGS digital elevation data were recorded. In addition the values topographical aspect, slope, curvature, topographical position index and topographical wetness index were calculated from the raw data, and each subplot's means of these values were included in the data used for analysis.  (Formal definitions of these topographical variables are available at <!--citation-->.) Figure \@ref(fig:processed-yield-as-applied) shows maps of the processed yield and as-applied data.  For more detailed explanation of data processing procedures, see <!--We need a cite, and we need to write up the cited document.-->

```{r machine-alignment, fig.cap = "Machinery alignment", eval = F}
include_graphics(machinery_alignment.png))) 
```

```{r gen-yield-nitrogen-map}
#/*----------------------------------*/
#' ## Yield
#/*----------------------------------*/

analysis_data_td <- trial_design %>% 
  filter(type != "Headland") %>% 
  analysis_data[., ]

if (sn_ew_ratio > 1.1) {
  tm_p_yield <- tm_shape(analysis_data_td) +
    tm_fill(
      col = "yield_vol", 
      palette = "YlOrBr",
      title = "Yield\n(bu/acre)",
      # legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      # legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
} else {
  tm_p_yield <- tm_shape(analysis_data_td) +
    tm_fill(
      col = "yield_vol", 
      palette = "YlOrBr",
      title = "Yield (bu/acre)",
      legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
}

#/*----------------------------------*/
#' ## Nitrogen rate
#/*----------------------------------*/
if (sn_ew_ratio > 1.1) {
  tm_p_nitrogen <- tm_shape(analysis_data_td) +
    tm_fill(
      col = "n_rate", 
      palette = "YlGn",
      title = "Nitrogen Rate\n(lbs)",
      # legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      # legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
} else {
  tm_p_nitrogen <- tm_shape(analysis_data_td) +
    tm_fill(
      col = "n_rate", 
      palette = "YlGn",
      title = "Nitrogen Rate (lbs)",
      legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
}

```

```{r  processed-yield-as-applied, echo = F, fig.cap = "Yield and as-applied nitrogen rates", dependson = "save-figures-yield-nitrogen-processed", fig.height = ifelse(sn_ew_ratio > 1.1, 5, 8)}

if (sn_ew_ratio > 1.1) {
  tmap_arrange(tm_p_nitrogen, tm_p_yield, ncol = 2)
} else {
  tmap_arrange(tm_p_nitrogen, tm_p_yield, ncol = 1)
}

```

# Defining Management Zones Using a Statistical Parameter

Management zones were identified using a statistical model that assumed that, on each site $i$ in the field, yield responds to nitrogen rate to on the following form:

$$
Yield_i = \alpha_i + \beta_i ln(Nitrogen) + v_i.
$$

The $\beta$ parameter is an estimate of the percentage change in yield give a 1% change in nitrogen rate.  A higher $\beta_i$ estimate predicts a higher yield response to nitrogen rate at site $i$, which implies a higher economically optimal nitrogen rate at that site.  Using a statistical technique called geographically weighted regression (GWR), a value of the beta parameter was estimated at each observation point in the field's processed data.  Figure \@ref(fig:map-response) displays the map of the values of $\beta$ on the field.

```{r gen-map-response}

data_sf_n_td <- trial_design %>% 
  filter(type != "Headland") %>% 
  data_sf_n[., ]

if (sn_ew_ratio > 1.1) {
  tm_beta <- tm_shape(data_sf_n_td) +
    tm_fill(
      col = "b_slope", 
      palette = "PuRd",
      title = "Yield\n(bu/acre)",
      # legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      # legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
} else {
  tm_beta <- tm_shape(data_sf_n_td) +
    tm_fill(
      col = "b_slope", 
      palette = "PuRd",
      title = "Yield (bu/acre)",
      legend.is.portrait = FALSE,
      style = "cont"
    ) +
    tm_layout_to_add + 
    tm_layout(
      legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
}

if (sn_ew_ratio > 1.1) {
  tm_zone <- tm_shape(data_sf_n_td) +
    tm_fill(
      col = "zone_txt", 
      palette = "YlGnBu",
      title = "Yield\n(bu/acre)",
      # legend.is.portrait = FALSE
    ) +
    tm_layout_to_add + 
    tm_layout(
      # legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
} else {
  tm_zone <- tm_shape(data_sf_n_td) +
    tm_fill(
      col = "zone_txt", 
      palette = "YlGnBu",
      title = "Yield (bu/acre)",
      legend.is.portrait = FALSE
    ) +
    tm_layout_to_add + 
    tm_layout(
      legend.outside.position = "bottom",
      legend.position = c(0.25, 0.25)
    )
}

```

```{r map-response, echo = F, fig.cap = "Map of the estimated values of the yield response parameter, $\\beta$ the derived management zone" , dependson = "gen-map-response", fig.height = ifelse(sn_ew_ratio > 1.1, 5, 8)}

if (sn_ew_ratio > 1.1) {
  tmap_arrange(tm_beta, tm_zone, ncol = 2)
} else {
  tmap_arrange(tm_beta, tm_zone, ncol = 1)
}

```

```{r ys-by-mz, fig.cap = "(Nitrogen rate, yield) data points for each management zones, and the estimated yield response curves derived from them", fig.height = 4}
#--- plot ---#
ggplot() +
  geom_point(
    data = filter(
      data_sf_n, 
      n_rate >= min(eval_data_n$n_rate),
      n_rate <= max(eval_data_n$n_rate),
    ), 
    aes(y = yield, x = n_rate),
    size = 0.4
  ) +
  geom_line(
    data = filter(eval_data_n, type == "opt_v"),
    aes(y = yield_hat, x = n_rate)
  ) +
  geom_ribbon(
    data = filter(eval_data_n, type == "opt_v"),
    aes(
      ymin = yield_hat - yield_hat_se * 1.96, 
      ymax = yield_hat + yield_hat_se * 1.96, 
      x = n_rate
    ),
    fill = "blue",
    alpha = 0.3
  ) +
  facet_grid(. ~ zone_txt) +
  xlab("Nitrogen Rate (lbs)") +
  ylab("Yield (bu/acre)") +
  theme(
    axis.title.x = element_text(size = 12, vjust = -1),
    axis.title.y = element_text(size = 12),
    axis.text.x = element_text(size = 12, angle = 90),
    axis.text.y = element_text(size = 12),
    strip.text = element_text(size = 12)
  ) +
  fig_theme_nonsp

```

The values of $\beta$ in all of the field's observation points were partitioned into three “zones,” with Zone 1 consisting of the observation points in the lowest third of estimated values of $\beta$, and Zones 2, and 3, containing the observations points from second and third thirds.  The bottom panel of Figure \@ref(fig:map-response) displays those zones.  Figure \@ref(fig:ys-by-mz) shows the zones' (nitrogen rate, yield) scatterplots and estimated yield response curves, which we produced using General Additive Model regression techniques. 

# Exploring Interactions between Nitrogen Rate and Field Characteristics in the Yield Response Function

The discussion thus far has offered statistical evidence of how yield responses and optimal management strategies differed among geographic areas of the field.  But intuitive, agronomy-based explanations have been provided to explain the statistical results.  To investigate why some areas may have higher yield responses than others, it is necessary to examine whether field characteristics interact field characteristics in the yield response function.  Roughly speaking, if a field characteristic interacts with nitrogen rate, it increases the slope of the yield-to-nitrogen response curve.  

Figure \@ref(fig:interaction) illustrates.In figure \@ref(fig:interaction), increasing the value of the field characteristic from $c^{low}$ to $c^{high}$ lowers the slope of the yield response curve.  The characteristic is said to interact negatively with nitrogen rate in affecting yield response.  Note that interaction refers to the slope of the yield response curve, not its height.  Increasing the level of the field characteristic does shift the yield response curve up, but because it also makes the yield response curve flatter, which implies the negative interaction.

```{r interaction, fig.cap = "Increasing the value of a field characteristics lowers the slope of the yield response curve. The characteristic is said to interact negatively with nitrogen rate when affecting yield response", cache = F, fig.height = 3, fig.width = 5}

gen_yield_chigh <- function(x) {
  80 + 50 * log(x - 20)
}

gen_yield_clow <- function(x) {
  -30 + 90 * log(x - 25)
}

plot_data <- data.table(x = seq(27, 40, length =1000)) %>% 
  .[,y_chigh := gen_yield_chigh(x)] %>% 
  .[,y_clow := gen_yield_clow(x)] %>% 
  melt(id.var = "x") %>% 
  .[, type := case_when(
    variable == "y_chigh" ~ "c_high",
    variable == "y_clow" ~ "c_low"
  )]

g_int <- ggplot(plot_data) +
  geom_line(aes(y = value, x = x, color = type)) +
  labs(x = 'Nitrogen Rate', y ='Yield') +
  geom_hline(yintercept = 27) +
  geom_vline(xintercept = 27) +
  scale_color_manual(
    values = c(
      "c_high" = "#000000", 
      "c_low" = "#C87700"
    )
  ) +
  annotate(
    'text',
    x = 32, y = 218,
    parse = TRUE, 
    label = ('f(nitrogen, c^{high})'),
    color = "#000000",
    size = 4,
    family = "Times",
    fontface = 3
  ) +
  annotate('text',
    x = 37,
    y = 164,
    parse = TRUE,
    label = 'f(nitrogen, c^{low})',
    color = "#C87700",
    size = 4,
    family = "Times",
    fontface = 3
  ) +
  theme(
    legend.position = "none",
  ) +
  fig_theme_nonsp

g_int

```

In terms of the model used in this analysis, correlation between the estimated parameter $\beta$ and a field characteristic offers evidence of interaction.  For the field_name_here field, the absolute values of the correlation coefficients were highest for the variables TWI, elevation, and ss_Mp.  TWI stands for topographical wetness index, which describes the tendency of an area of land to accumulate water.  ss_Mp is a variable that indicates whether the data point comes from a location in which the soil is classified as Mobridge-Plankington silt loam.  (All such areas are shaded in figure \@ref(fig:explore-map).)  Figure \@ref(fig:explore-plot) shows how yield response curves differed given different levels of these three interaction terms.  The northeast panel of figure 13 shows that yield is noticeably less responsive to nitrogen rate on the Belmore loam soil than on the rest of the field.  The southwest panel shows the same for the Eakin-Rabin soil.  The northwest panel illustrates that yield tended to respond poorly to nitrogen rates in low-elevation areas.  Interpretation of the northwest panel is a little more complicated;  It seems to show that at on flat soils, when beginning at low rates, an increase in nitrogen reduced yield, but at higher nitrogen rates on flat land, increasing the rate had a strong positive affect on yields.  This difficult-to-interpret result is a reminder that data analysis carries with it inherent uncertainty, and that treating uncertain occurrences as if they were determinate can lead to misleading conclusions 



```{r map-ys-char-11, dependson = "gen-ex-figs", eval = F}
ys_by_char_n[[2]]
```


```{r map-ys-char-12, dependson = "gen-ex-figs", eval = F}
ys_by_char_n[[1]]
```
